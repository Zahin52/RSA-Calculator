<!doctype htmx>
<htmx lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <title>RSA CALCULATOR</title>
  <style>
    html {
      /* overflow-x: hidden; */
      scroll-behavior: smooth;
    }

    body {
      background: url(https://marktossell.files.wordpress.com/2018/08/security.jpg) no-repeat center center;
      background-attachment: fixed;
      background-size: cover;
      color: aliceblue;

      /* scroll-behavior: smooth;
      transition: all 2s linear; */
      width: 100%;
      height: 100vh !important;
      scroll-behavior: smooth;
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
    }

    /* .wrapper{
      width: 100vw;
      height: 100vh !important;
      scroll-behavior: smooth;
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
    } */
    .form-group{
      width: 100% !important;
      padding: 0%;
    }
    @media (max-width:800px) {
      .wrapit{
      flex-wrap: wrap;
    }
    .ml-2{
      margin-left: 0% !important;
    }
    .mr-2{
      margin-right: 0% !important;
    }
    #textArea h3{
      font-size: 20px;
    }
    }

    #myBtn {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 30px;
      z-index: 99;
      font-size: 18px;
      border: none;
      outline: none;
      background-color: red;
      color: white;
      cursor: pointer;
      padding: 15px;
      border-radius: 4px;
    }

    #myBtn:hover {
      background-color: #555;
    }

    section:first-child {
      /* background: url(https://www.cybersecurity-insiders.com/wp-content/uploads/2019/12/cybersecurity-istockphoto-kqv-621x414@LiveMint.jpg) no-repeat center center;
      background-attachment: fixed;
      background-size: cover;
      color: aliceblue; */
      color: rgb(255, 255, 255);
      text-shadow: rgb(29, 31, 31);
      border: none !important;
      background: transparent !important;
      width: 100% !important;
      height: 100vh !important;
    }

    section:first-child h3 {
      font-size: 60px !important;
      color: black;
      -webkit-text-fill-color: white;
      /* Will override color (regardless of order) */
      -webkit-text-stroke: 1px black;
      -webkit-text-fill-color: white;
      text-shadow:
        3px 3px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        1px 1px 0 #000;
    }

    section {
      width: 100% !important;
      height: 100vh !important;
      background: rgba(156, 152, 152, 0.623);
      padding: 10px;
      color: rgb(255, 255, 255);
      border: 1px white solid;
      scroll-snap-align: center;
    }

    .container {
      /* overflow: scroll !important; */
      scroll-behavior: smooth !important;
      scroll-snap-type: mandarory !important;
    }
  </style>
</head>



<body class="wrapper">
  <div class="container">
    <section class="d-flex  flex-wrap justify-content-center flex-column align-items-center">
      <h3 class="text-center">Welcome to RSA Calculator</h3>
    </section>
    <section id="PQ" class="my-2  d-flex justify-content-center flex-column align-items-center ">
      <div class="  d-flex justify-content-center flex-column align-items-center w-75">
        <div class="d-flex justify-content-between w-100 wrapit">
          <div class="form-group mr-2">
            <label for="p">Enter P</label>
            <input type="text" class="form-control" id="p" placeholder="Enter the value of P">
          </div>
          <div class="form-group ml-2">
            <label for="q">Enter Q</label>
            <input type="text" class="form-control" id="q" placeholder="Enter the value of Q">
          </div>
        </div>
        <div class="d-flex justify-content-center w-100 wrapit">
          <button class="btn-primary pq-setter form-control ">Submit</button>
        </div>
      </div>
      <div id="k_fi" class="d-flex justify-content-center my-2 w-75">
        <div class="d-flex justify-content-between w-100 wrapit">
          <div class="form-group mr-2">
            <label for="n">Value of n=p*q</label>
            <input type="text" class="form-control" id="n" placeholder="Enter the value of n">
          </div>
          <div class="form-group ml-2">
            <label for="q">Value of ϕ (n)=(p-1)*(q-1)</label>
            <input type="text" class="form-control" id="fi" placeholder="Enter the value of ϕ (n)">
          </div>
        </div>
      </div>

    </section>

    <!-- <section id="k_fi" class="d-flex justify-content-center my-2 border" >
        <div class="d-flex justify-content-between w-75">
          <div class="form-group mx-2">
            <label for="n">Value of n=p*q</label>
            <input type="text" class="form-control" id="n" placeholder="Enter the value of n">
          </div>
          <div class="form-group mx-2">
            <label for="q">Value of ϕ (n)=(p-1)*(q-1)</label>
            <input type="text" class="form-control" id="fi" placeholder="Enter the value of ϕ (n)">
          </div>  
        </div>      
      </section> -->

    <section id="textArea" class="d-flex justify-content-center  flex-column align-items-center ">
      <span class="d-flex justify-content-center flex-wrap">
        <h3 class="text-center ">Candidates of 1 modϕ (n)</h3>
      </span>
      <textarea name="" id="candidates" class="w-75" rows="5"></textarea>
      <div id="k_part" class="d-flex justify-content-center flex-column align-items-center my-2 w-75">
        <div class="d-flex justify-content-between  w-100 wrapit">
          <input id="k" class="form-control mr-2 my-2" placeholder="Give a value from candidate" type="text">
          <button class="form-control btn-primary ml-2 my-2 check_k">Check K</button>
        </div>
        <div id="ED" class="d-flex justify-content-between my-2 w-100">
          <div class="d-flex justify-content-between w-100 wrapit">
            <input id="e" class="form-control my-2 mr-2" placeholder="Give a value of e from factors" type="text">
            <input id="d" class="form-control my-2 ml-2" placeholder="Give a value of d from factors" type="text">
          </div>
        </div>
      </div>
    </section>

    <!-- <section id="k_part" class="d-flex justify-content-center flex-column align-items-center my-2 ">
        <div class="d-flex justify-content-between w-75 ">
          <input id="k" class="form-control mx-2" placeholder="Give a value from candidate" type="text">
          <button class="form-control btn-primary mx-2 check_k">Check K</button>
        </div>
        <div id="ED" class="d-flex justify-content-between my-2 w-75">
          <div class="d-flex justify-content-between w-100 ">
            <input id="e" class="form-control mx-2" placeholder="Give a value of e from factors" type="text">
            <input id="d" class="form-control mx-2" placeholder="Give a value of d from factors" type="text">
          </div>
        </div>
      </section> -->

    <!-- <section id="ED" class="d-flex justify-content-center my-2 border">
        <div class="d-flex justify-content-between w-75 ">
          <input id="e" class="form-control mx-2" placeholder="Give a value of e from factors" type="text">
          <input id="d" class="form-control mx-2" placeholder="Give a value of d from factors" type="text">
        </div>
      </section> -->

    <section id="encryptDecrypt" class="d-flex justify-content-center flex-column align-items-center my-2 ">
      <div class="d-flex justify-content-between w-75 flex-wrap">
        <input id="msg" class="form-control  my-2" placeholder="Message" type="text">
        <input id="enText" class="form-control  my-2" placeholder="Encrypted text" type="text">
        <input id="en" class="form-control  my-2" placeholder="Encrypted Number" type="text">
        <input id="de" class="form-control  my-2" placeholder="Decrypted text" type="text">
        <button class="form-control btn-primary  my-2 magicBTN">Magic</button>
      </div>
    </section>


  </div>
</body>
<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
  integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
  integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/ScrollTrigger.min.js"></script>

<script>
  const isPrime = num => {
    for (let i = 2, s = Math.sqrt(num); i <= s; i++)
      if (num % i === 0) return false;
    return num > 1;
  }

  const getPrimeFactorsFor = (num) => {
    const primes = [];
    console.log(num);
    for (let factor = 2; factor <= num; factor++) {
      while ((num % factor) == 0) {
        console.log(num, " ", factor);
        primes.push(factor);
        num /= factor;
      }
    }
    console.log(primes);
    return primes;
  }

  function powermod(base, exponent, modulus) {
    if (base < 1 || exponent < 0 || modulus < 1)
      return -1

    var result = 1;
    while (exponent > 0) {
      if ((exponent % 2) == 1) {
        result = (result * base) % modulus;
      }
      base = (base * base) % modulus;
      exponent = Math.floor(exponent / 2);
    }
    return result;
  }


  $(".pq-setter").click(() => {
    var p_value = $("#p").val();
    var q_value = $("#q").val();

    var n_value = p_value * q_value;
    var fi_value = (p_value - 1) * (q_value - 1);
    $("#n").val(n_value);
    $("#fi").val(fi_value);
    $("#candidates").val("");
    for (var i = 1; i <= 30; i++) {
      var candidatesVal = $("#candidates").val() + ((fi_value * i) + 1) + " ";
      $("#candidates").val(candidatesVal);
    }

  });
  $(".check_k").click(() => {
    var k = $("#k").val();
    var checker = isPrime($("#k").val());
    if (checker) {
      alert("K is a prime number ,Change it");
    } else {
      //alert("put e and d in the respective boxes");
      var primes = getPrimeFactorsFor(k);
      console.log(primes);
      alert("prime factors are =>" + primes.join("*"));
    }
  });

  $(".magicBTN").click(() => {
    console.log("ssss");
    var en = [],
      den = [],
      encodeText = [];
    var msg = $("#msg").val();
    var e = $("#e").val();
    var d = $("#d").val();
    var n = $("#n").val();
    for (var i of msg) {

      en.push(powermod(i.charCodeAt(), e, n));
      console.log(i, i.charCodeAt());
    }
    for (var k of en) {
      console.log(k);
      encodeText.push(String.fromCharCode(k));
      var de = powermod(k, d, n);
      den.push(String.fromCharCode(de));
    }

    var encode = en.join(",");
    var encodeTEXTs = encodeText.join("");
    var decode = den.join("");

    //var de = powermod(en,d,n);
    console.log(msg, en, decode);
    $("#en").val(encode);
    $("#enText").val(encodeTEXTs);
    $("#de").val(decode);
  });
</script>

<script>
  //Get the button
  var mybutton = document.getElementById("myBtn");

  // When the user scrolls down 20px from the top of the document, show the button
  window.onscroll = function () {
    scrollFunction()
  };

  function scrollFunction() {
    if (document.querySelector("body").scrollTop > 20 || document.querySelector("body").scrollTop > 20) {
      mybutton.style.display = "block";
    } else {
      mybutton.style.display = "none";
    }
  }

  // When the user clicks on the button, scroll to the top of the document
  function topFunction() {
    document.querySelector("body").scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }
</script>

</body>

</htmx>
